<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span>  <span class="var type1" id="S2T1U3">gxh</span>=<span class="message error" id="M1F1C">pp</span>( <span class="var type0" id="S3T0U6">h</span>,<span class="var type0" id="S4T0U7">pr</span>,<span class="var type0" id="S5T0U8">pc</span>,<span class="var type0" id="S6T0U9">pa</span>,<span class="var type0" id="S7T0U10">pb</span>,<span class="var type0" id="S8T0U11">maxStep</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"><span class="var type0" id="S3T0U14">h</span>=<span class="var type0" id="S3T0U16"><span class="message error" id="M2F1C">h</span></span>(:,1:260,:);</span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"><span class="var type0" id="S9T0U24">gh</span>=rgb2gray(<span class="var type0" id="S3T0U27"><span class="message error" id="M3F1C">h</span></span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"><span class="var type0" id="S11T0U30">eh</span>=edge(<span class="var type0" id="S9T0U33"><span class="message error" id="M4F1C">gh</span></span>,<span class="string">'canny'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">%figure;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">%subplot(1,2,1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">%imshow(eh);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">%******constrain the arguments.*******</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line"><span class="var type0" id="S6T0U37">pa</span>=setInRange(<span class="var type0" id="S6T0U40"><span class="message error" id="M5F1C">pa</span></span>,size(<span class="var type0" id="S3T0U43">h</span>,1));</span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line"><span class="var type0" id="S7T0U47">pb</span>=setInRange(<span class="var type0" id="S7T0U50"><span class="message error" id="M6F1C">pb</span></span>,size(<span class="var type0" id="S3T0U53">h</span>,2));</span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line"><span class="var type0" id="S4T0U57">pr</span>=setInRange(<span class="var type0" id="S4T0U60"><span class="message error" id="M7F1C">pr</span></span>,size(<span class="var type0" id="S3T0U63">h</span>,1));</span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line"><span class="var type0" id="S5T0U67">pc</span>=setInRange(<span class="var type0" id="S5T0U70"><span class="message error" id="M8F1C">pc</span></span>,size(<span class="var type0" id="S3T0U73">h</span>,2));</span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line"><span class="var type0" id="S6T0U77">pa</span>=setStep(<span class="var type0" id="S6T0U80"><span class="message error" id="M9F1C">pa</span></span>,<span class="var type0" id="S8T0U81">maxStep</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line"><span class="var type0" id="S7T0U84">pb</span>=setStep(<span class="var type0" id="S7T0U87"><span class="message error" id="M10F1C">pb</span></span>,<span class="var type0" id="S8T0U88">maxStep</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line"><span class="var type0" id="S4T0U91">pr</span>=setStep(<span class="var type0" id="S4T0U94"><span class="message error" id="M11F1C">pr</span></span>,<span class="var type0" id="S8T0U95">maxStep</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line"><span class="var type0" id="S5T0U98">pc</span>=setStep(<span class="var type0" id="S5T0U101"><span class="message error" id="M12F1C">pc</span></span>,<span class="var type0" id="S8T0U102">maxStep</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line">assert(1&lt;=<span class="var type0" id="S4T0U109">pr</span>(1));</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line">assert(<span class="mxinfo" id="T1:U2"><span class="mxinfo" id="T1:U3">size(<span class="var type0" id="S3T0U117">h</span>,<span class="mxinfo" id="T1:U4">1</span>)&gt;=<span class="var type0" id="S4T0U120"><span class="message error" id="M13F1C">pr</span></span>(3)</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line">assert(1&lt;=<span class="var type0" id="S5T0U128">pc</span>(1))</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line">assert(<span class="mxinfo" id="T1:U5"><span class="mxinfo" id="T1:U6">size(<span class="var type0" id="S3T0U136">h</span>,<span class="mxinfo" id="T1:U7">2</span>)&gt;=<span class="var type0" id="S5T0U139"><span class="message error" id="M14F1C">pc</span></span>(3)</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line"><span class="comment">%************end constrain arguments.***********</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line">[<span class="var type0" id="S17T0U144">r</span> <span class="var type0" id="S18T0U145">c</span> <span class="var type0" id="S19T0U146">a</span> <span class="var type0" id="S20T0U147">b</span>]=detectRect(<span class="var type0" id="S11T0U150">eh</span>,<span class="var type0" id="S4T0U151">pr</span>,<span class="var type0" id="S5T0U152">pc</span>,<span class="var type0" id="S6T0U153">pa</span>,<span class="var type0" id="S7T0U154">pb</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line"><span class="var type0" id="S19T0U157">a</span>=<span class="var type0" id="S19T0U159">a</span>+<span class="var type0" id="S6T0U161">pa</span>(2);</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line"><span class="var type0" id="S20T0U165">b</span>=<span class="var type0" id="S20T0U167">b</span>+<span class="var type0" id="S7T0U169">pb</span>(2);</span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line"><span class="var type0" id="S22T0U173">rr</span>=rect(size(<span class="var type0" id="S3T0U178">h</span>),<span class="var type0" id="S17T0U179">r</span>,<span class="var type0" id="S18T0U180">c</span>,<span class="var type0" id="S19T0U181">a</span>,<span class="var type0" id="S20T0U182">b</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line">size(<span class="var type0" id="S22T0U186">rr</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line"><span class="var type0" id="S24T0U189">rrr</span>=repmat(<span class="var type0" id="S22T0U192">rr</span>,[1 1 3]);</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line">size(<span class="var type0" id="S3T0U201">h</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line">size(<span class="var type0" id="S24T0U205">rrr</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">30</a></span><span class="line"><span class="comment">%h(rrr==1)=0;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31">31</a></span><span class="line"><span class="var type0" id="S26T0U208">lr</span>=<span class="var type0" id="S17T0U210">r</span>-<span class="var type0" id="S19T0U211">a</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32">32</a></span><span class="line"><span class="var type0" id="S22T0U214">rr</span>=<span class="var type0" id="S17T0U216">r</span>+<span class="var type0" id="S19T0U217">a</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33">33</a></span><span class="line"><span class="var type0" id="S27T0U220">lc</span>=<span class="var type0" id="S18T0U222">c</span>-<span class="var type0" id="S20T0U223">b</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34">34</a></span><span class="line"><span class="var type0" id="S28T0U226">rc</span>=<span class="var type0" id="S18T0U228">c</span>+<span class="var type0" id="S20T0U229">b</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35">35</a></span><span class="line"><span class="var type2" id="S2T0U232">gxh</span>=<span class="var type0" id="S9T0U234">gh</span>(<span class="var type0" id="S26T0U236">lr</span>:<span class="var type0" id="S22T0U237">rr</span>,<span class="var type0" id="S27T0U239">lc</span>:<span class="var type0" id="S28T0U240">rc</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36">36</a></span><span class="line"><span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37">37</a></span><span class="line">rho1=detectLine(eh);</span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38">38</a></span><span class="line">from=round(size(h,2)/2)</span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39">39</a></span><span class="line">rho2=from+detectLine(eh(:,from:end,:));</span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40">40</a></span><span class="line">imshow(eh(:,from:end,:));</span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41">41</a></span><span class="line">oh=h;</span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42">42</a></span><span class="line">rho1</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43">43</a></span><span class="line">rho2</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44">44</a></span><span class="line">oh(:,rho1,:)=0;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45">45</a></span><span class="line">oh(:,rho2,:)=0;</span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46">46</a></span><span class="line">imshow(oh);</span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47">47</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
